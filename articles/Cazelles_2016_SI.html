<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cazelles et al. (2016): Supplementary Information • biogeonet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cazelles et al. (2016): Supplementary Information">
<meta property="og:description" content="biogeonet">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biogeonet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cazelles_2016.html">Cazelles et al. (2016)</a>
    </li>
    <li>
      <a href="../articles/Cazelles_2016_SI.html">Cazelles et al. (2016): Supplementary Information</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KevCaz/biogeonet/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cazelles et al. (2016): Supplementary Information</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KevCaz/biogeonet/blob/master/vignettes/Cazelles_2016_SI.Rmd"><code>vignettes/Cazelles_2016_SI.Rmd</code></a></small>
      <div class="hidden name"><code>Cazelles_2016_SI.Rmd</code></div>

    </div>

    
    
<div id="stochastic-rules-in-macarthur-wilsons-model" class="section level1">
<h1 class="hasAnchor">
<a href="#stochastic-rules-in-macarthur-wilsons-model" class="anchor"></a><span class="header-section-number">1</span> Stochastic rules in MacArthur &amp; Wilson’s model</h1>
<p>Following the Theory of Island Biogeography<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> (hereafter TIB), we based our work on stochastic
models. Let <span class="math inline">\(X_{i}\)</span> be the random variable of presence on islands of a
species <span class="math inline">\(i\)</span>; <span class="math inline">\(X_i=1\)</span> means “species i is present on the island” while
<span class="math inline">\(X_i=0\)</span> means “species i is not found on the island”; <span class="math inline">\(X_i\)</span> is a
Bernoulli random variable. We define this probability at any time <span class="math inline">\(t&gt;0\)</span>
and <span class="math inline">\(X_{i,t}\)</span> is the associated stochastic process. Moreover, let <span class="math inline">\(c_i\)</span>
(<span class="math inline">\(e_i\)</span>) be the probability of colonization (extinction) of species <span class="math inline">\(i\)</span>
per time unit. To compute <span class="math inline">\(X_t+dt\)</span> based on <span class="math inline">\(X_t\)</span>, we have to derive
<span class="math inline">\(\mathbb{P}(X_{i,t+dt}|X_{i,t})\)</span>. As <span class="math inline">\(X_{i,t}\)</span> has two possible values
leading to four possibilities:</p>
<p><span class="math display">\[
\nonumber \forall (t,c_i, e_i,dt)\in (\mathbb{R}^{+})^{4}:
\]</span></p>
<p><span class="math display" id="eq:A2p1">\[
\label{eqAnn2_1} \mathbb{P}(X_{i,t+dt}=1|X_{i,dt}=0) = c_idt + o(dt)
\tag{1.1}
\]</span></p>
<p><span class="math display" id="eq:A2p2">\[
\mathbb{P}(X_{i,t+dt}=0|X_{i,t}=1) = e_idt + o(dt)
\tag{1.2}
\]</span></p>
<p><span class="math display" id="eq:A2p3">\[
\mathbb{P}(X_{i,t+dt}=0|X_{i,t}=0) = (1-c_idt) + o(dt)
\tag{1.3}
\]</span></p>
<p><span class="math display" id="eq:A2p4">\[
\mathbb{P}(X_{i,t+dt}=1|X_{i,t+dt}=1) = (1-e_idt) + o(dt)
\tag{1.4}
\]</span></p>
<p>Where <span class="math inline">\(dt\)</span> is defined such as <span class="math inline">\(e_idt&lt;1\)</span> and <span class="math inline">\(c_idt&lt;1\)</span>. For the remaining
analyses, we use the symbol <span class="math inline">\(o(dt)\)</span> defines as follows:</p>
<p><span class="math display" id="eq:A2pp1">\[
\lim\limits_{\substack{dt \to 0 \\ dt&gt;0}}\frac{o(dt)}{dt} = 0
\tag{1.5}
\]</span></p>
<p>According to <a href="#eq:A2p1">(1.1)</a>, during <span class="math inline">\(dt\)</span>, species <span class="math inline">\(i\)</span> has a probability of
<span class="math inline">\(c_idt\)</span> of colonizing the island by a single colonization event and <span class="math inline">\(o(dt)\)</span> of
colonizing it by multiple colonization/extinction events (<em>e.g</em>
colonization-extinction-colonization). These multiple events are less likely and
neglected when <span class="math inline">\(dt\)</span> tends towards <span class="math inline">\(0\)</span>. Similarly, <a href="#eq:A2p2">(1.2)</a> is the
probability of species <span class="math inline">\(i\)</span> becoming extinct during <span class="math inline">\(dt\)</span>, <a href="#eq:A2p3">(1.3)</a> gives us
the probability of species <span class="math inline">\(i\)</span> maintaining it-self on island and<a href="#eq:A2p4">(1.4)</a>
provides probability of species <span class="math inline">\(i\)</span> staying out of the island. The distribution
<span class="math inline">\(\mathcal{L}(X_{i,t+dt}|X_{i,t})\)</span> solely depends on the duration <span class="math inline">\(dt\)</span> not on
<span class="math inline">\(t\)</span>, <span class="math inline">\(X_{i,t}\)</span> is a no memory process, also called a first order discrete Markov
chain. As <span class="math inline">\(\{X_{i,t}=0, X_{i,t}=1\}\)</span> is a partition:</p>
<p><span class="math display" id="eq:A2pp2">\[
\begin{aligned}
\nonumber  \mathbb{P}(X_{i,t+dt}=1)&amp;=&amp; \mathbb{P}(X_{i,t+dt}=1|X_{i,t}=0) \mathbb{P}(X_{i,t}=0) + \\
          &amp; &amp; \mathbb{P}(X_{i,t+dt}=1|X_{i,t}=1) \mathbb{P}(X_{i,t}=1)
\end{aligned}
\tag{1.6}
\]</span></p>
<p>At time <span class="math inline">\(t+dt\)</span>, species <span class="math inline">\(i\)</span> will be on the island either because species
<span class="math inline">\(i\)</span> has colonized during <span class="math inline">\(dt\)</span> or because it has not died out from there.
By using <span class="math inline">\(\mathbb{P}(X_{i,t}=0)=1- \mathbb{P}(X_{i,t}=1)\)</span>:</p>
<p><span class="math display" id="eq:A2pp3">\[
\begin{aligned}
\mathbb{P}(X_{i,t+dt}=1)&amp;=&amp;c_idt(1- \mathbb{P}(X_{i,t}=1))+(1-e_idt) \mathbb{P}(X_{i,t}=1)+o(dt)
\end{aligned}
\tag{1.7}
\]</span></p>
<p>Let <span class="math inline">\(p_{i,t}\)</span> stand for <span class="math inline">\(\mathbb{P}(X_{i,t}=1)\)</span>:</p>
<p><span class="math display" id="eq:A2pp4">\[
p_{i,t+dt} = c_idt(1-p_{i,t})+(1-e_idt)p_{i,t}+o(dt)
\tag{1.8}
\]</span></p>
<p><span class="math inline">\(dt&gt;0\)</span>, then:</p>
<p><span class="math display" id="eq:A2pp5">\[
\frac{p_{i,t+dt}-p_{i,t}}{dt} = c_i(1-p_{i,t})-e_ip_{i,t}+\frac{o(dt)}{dt}
\tag{1.9}
\]</span></p>
<p>By passing to the limit, we finally find MacArthur and Wilson’s model
for one species:</p>
<p><span class="math display" id="eq:A9">\[
\frac{dp_{i}}{dt} = c_i(1-p_{i})-e_ip_{i}
\tag{1.10}
\]</span></p>
<p>Similarly:</p>
<p><span class="math display" id="eq:A10">\[
\frac{d(1-p_{i})}{dt} = e_i(1-p_{i})-c_ip_{i}
\tag{1.11}
\]</span></p>
<p>Equation <a href="#eq:A9">(1.10)</a> describes distribution of <span class="math inline">\(X_{i,t&gt;0}\)</span>: for any <span class="math inline">\(t\)</span>, <span class="math inline">\(X_t\)</span>
follows a Bernoulli distribution with parameter <span class="math inline">\(p_i(t)\)</span>. Equations <a href="#eq:A9">(1.10)</a>
and <a href="#eq:A10">(1.11)</a> jointly describe a continuous time Markov Chain. We now
consider the vector <span class="math inline">\(\mathbf{C}(t)\)</span> defined for any positive real number <span class="math inline">\(t\)</span> as:</p>
<p><span class="math display" id="eq:A11">\[
\begin{aligned}
\mathbf{C}(t) = \left(\begin{array}{cc}p_{i,t} &amp; 1-p_{i,t} \end{array}\right)
\end{aligned}
\tag{1.12}
\]</span></p>
<p>the derivative is then:</p>
<p><span class="math display" id="eq:A2pp6">\[
\begin{aligned}
\label{eqAnn2_12} \mathbf{C}'(t)=\mathbf{C}(t)\left(\begin{array}{cc}-e_i &amp; e_i \\c_i &amp; -c_i\end{array}\right)= \mathbf{C}(t)\mathbf{G}
\end{aligned}
\tag{1.13}
\]</span></p>
<p><span class="math inline">\(\mathbf{G}\)</span> is the generator matrix of a continuous-time Markov chain
associated to the classical model of MacArthur and Wilson. This provides
the system of differential equations depicting the dynamics of the two
possible states (with or without species <span class="math inline">\(i\)</span>) the island can be found.</p>
</div>
<div id="a-markov-chains-model-to-describe-island-communities" class="section level1">
<h1 class="hasAnchor">
<a href="#a-markov-chains-model-to-describe-island-communities" class="anchor"></a><span class="header-section-number">2</span> A Markov chains model to describe island communities</h1>
<div id="model-for-p-non-interacting-species" class="section level2">
<h2 class="hasAnchor">
<a href="#model-for-p-non-interacting-species" class="anchor"></a><span class="header-section-number">2.1</span> Model for <span class="math inline">\(P\)</span> non-interacting species</h2>
<p>We now consider a pool of <span class="math inline">\(P\)</span> species (<span class="math inline">\(P\)</span> is a natural number). When
species are independent, the species richness on the island can be
described as a sum of the random processes associated to the <span class="math inline">\(P\)</span>
species:</p>
<p><span class="math inline">\(\mathbf{S_{t&gt;0}} = \mathbf{X_{1,t&gt;0}} + \mathbf{X_{2,t&gt;0}} + .... + \mathbf{X_{P,t&gt;0}}\)</span>.
As species are supposed to be independent, at any time <span class="math inline">\(t\)</span>:</p>
<p><span class="math display" id="eq:commu1">\[
\mathbb{E}(S_t) = \sum_{i=0}^Pp_i(t)
\tag{2.1}
\]</span></p>
<p>For homogeneous colonization and extinction rates among species, we directly
obtain a solution: for any time <span class="math inline">\(t\)</span>, <span class="math inline">\(S_t\sim \mathcal{B}(P,Pp_i(t))\)</span>.
<span class="math inline">\(\mathbb{E}(S_t)\)</span> stands then for the solution of the classical
differential equation with <span class="math inline">\(P\)</span> species.</p>
</div>
<div id="p-interacting-species" class="section level2">
<h2 class="hasAnchor">
<a href="#p-interacting-species" class="anchor"></a><span class="header-section-number">2.2</span> <span class="math inline">\(P\)</span> Interacting species</h2>
<p>When species are assumed to interact, the composition of insular communities
must be integrated and must influence the colonization/extinction dynamics.
Consequently, we gather species processes within
<span class="math inline">\(\mathbf{Y_{t&gt;0}}=(\mathbf{X_{1,t&gt;0}}, \mathbf{X_{2,t&gt;0}}, ...., \mathbf{X_{P,t&gt;0}})\)</span>. For any <span class="math inline">\(t\)</span> value, the line vector
<span class="math inline">\(\mathbf{\mathbf{Y_t}}=(X_{1,t}, X_{2,t}, ...., X_{P,t})\)</span> contains presence and
absence on the island for all the species of the network. Each of
<span class="math inline">\(\mathbf{\mathbf{Y_t}}\)</span> elements takes a values of 0 or 1, then
<span class="math inline">\(\mathbf{\mathbf{Y_t}}\in \{0,1\}^P\)</span>. Elements of matrix <span class="math inline">\(\mathbf{A}\)</span>,
<span class="math inline">\(\alpha_{i,j}\)</span>, describe the demographical impact of species <span class="math inline">\(j\)</span> on species <span class="math inline">\(i\)</span>.
At time <span class="math inline">\(t\)</span>, the total influence of insular species on a given species <span class="math inline">\(i\)</span>,
<span class="math inline">\(v_i\)</span> is:</p>
<p><span class="math display" id="eq:commu2">\[
v_{i,t} = (\mathbf{A}\mathbf{\mathbf{Y_t}}^T)_i = \sum_{j=1}^P\alpha_{ij}\ast x_{j,t}
\tag{2.2}
\]</span></p>
<p>Where <span class="math inline">\(^T\)</span> denotes the transposition operator, <span class="math inline">\(()_i\)</span> denotes the
<span class="math inline">\(i^{\text{th}}\)</span> column and <span class="math inline">\(x_{j,t}\)</span> the values of <span class="math inline">\(X_{j,t}\)</span> (<span class="math inline">\(0\)</span> or
<span class="math inline">\(1\)</span>). We then use a function to change extinction and colonization rates
according to <span class="math inline">\(v_i\)</span>. Extinction rate of species <span class="math inline">\(i\)</span> is therefore denoted
<span class="math inline">\(f_i\)</span> highlighting that it is a function of <span class="math inline">\(v_i\)</span>. Similarly, <span class="math inline">\(g_i\)</span>
stands for the colonization rate, this is a function of <span class="math inline">\(v_i\)</span>.</p>
<p>The conditional probability <span class="math inline">\(\mathbb{P}(\mathbf{Y_{t+dt}}|\mathbf{Y_t})\)</span>
is now examined. For <span class="math inline">\(P\)</span> species, there is <span class="math inline">\(2^P\)</span> possible values for
<span class="math inline">\(\mathbf{Y_t}\)</span>. Let <span class="math inline">\(T_k\)</span> (<span class="math inline">\(k\in \{1, 2,...., 2^P\}\)</span>) represent on of
these values (a given species assemblage). We have to split species into
four different categories: <span class="math inline">\(I_1\)</span>, <span class="math inline">\(I_2\)</span>, <span class="math inline">\(I_3\)</span> et <span class="math inline">\(I_4\)</span> relatively to
their presence on the island. This refers to the four potential
situations we have noticed earlier:</p>
<p><span class="math display" id="eq:commu3">\[
\begin{aligned}
\forall{t} &gt;0, ~\forall{(k,j)} \in \{1, 2,...., 2^P\}^2: &amp; &amp;\\
\mathbb{P} \mathbf{\mathbf{Y_{t+dt}}} = \mathbf{T_l}|\mathbf{\mathbf{Y_t}}=\mathbf{T_k})
 &amp; = &amp; \mathbb{P}\left(
    \bigcap_{\substack{i_1\in I_1}}(X_{i_1,t+dt}=1|X_{i_1,t}=0)\right., \\
  \nonumber &amp; &amp; \bigcap_{\substack{i_2\in I_2}}(X_{i_2,t+dt}=0|X_{i_2,t}=1), \\
  \nonumber &amp; &amp; \bigcap_{\substack{i_3\in I_3}}(X_{i_3,t+dt}=1|X_{i_3,t}=1), \\
  \label{eqAnn2_13} &amp; &amp; \left.\bigcap_{\substack{i_4\in I_4}}(X_{i_4,t+dt}=0|X_{i_4,t}=0)\right)
\end{aligned}
\tag{2.3}
\]</span></p>
<p>Species are interdependent which apparently prevents from getting simple
results. Nevertheless, with <span class="math inline">\(dt\)</span> enough small, the island composition
could be regarded as constant during <span class="math inline">\(dt\)</span>. Extinction probability is
thus calculated at time <span class="math inline">\(t\)</span> and fixed until <span class="math inline">\(t+dt\)</span>:</p>
<p><span class="math display" id="eq:commu4">\[
\begin{aligned}
\mathbb{P}(\mathbf{\mathbf{Y_{t+dt}}} = \mathbf{T_l}|\mathbf{\mathbf{Y_t}} = \mathbf{T_k}) = \prod_{\substack{i_1\in I_1}}\mathbb{P}(X_{i_1,t+dt}=1|X_{i_1,t}=0) \\
          \prod_{\substack{i_2\in I_2}}\mathbb{P}(X_{i_2,t+dt}=0|X_{i_2,t}=1)  \\
         \prod_{\substack{i_3\in I_3}}\mathbb{P}(X_{i_3,t+dt}=1|X_{i_3,t}=1) \\
 \prod_{\substack{i_4\in I_4}}\mathbb{P}(X_{i_4,t+dt}=0|X_{i_4,t}=0)
\end{aligned}
\tag{2.4}
\]</span></p>
<p>The previous assumption leads us to consider multiple events as null-probability
events, so we assume <span class="math inline">\(dt\)</span> enough small to get <span class="math inline">\(o(dt)=0\)</span>.</p>
<p><span class="math display" id="eq:prod4">\[
\mathbb{P}(\mathbf{\mathbf{Y_{t+dt}}} \mathbf{T_l}|\mathbf{\mathbf{Y_t}} = \mathbf{T_k}) = \prod_{\substack{i_1\in I_1}}g_{i_1}(v_{i_1,t})dt \prod_{\substack{i_2\in I_2}}f_{i_2}(v_{i_2,t})dt
\prod_{\substack{i_3\in I_3}}(1-f_{i_3}(v_{i_3,t})dt ) \prod_{\substack{i_4\in I_4}}(1-g_{i_4}(v_{i_4,t})dt)
\tag{2.5}
\]</span></p>
</div>
</div>
<div id="environmental-gradient-and-island-biogeography" class="section level1">
<h1 class="hasAnchor">
<a href="#environmental-gradient-and-island-biogeography" class="anchor"></a><span class="header-section-number">3</span> Environmental gradient and island biogeography</h1>
<p>Let <span class="math inline">\(\mathbf{W}=(W_1, W_2, ...., W_n)\)</span> be the vector gathering the <span class="math inline">\(n\)</span>
components of the environmental gradient considered; <span class="math inline">\(\mathbf{w}\)</span> will
be a vector giving a specific set of values for the environmental
gradient. Colonization and extinction rates are influenced by
environmental gradients. Consequently, for species <span class="math inline">\(i\)</span>, functions <span class="math inline">\(g_i\)</span>
and <span class="math inline">\(f_i\)</span> become multiple inputs functions. Equation <a href="#eq:prod4">(2.5)</a> then becomes:</p>
<p><span class="math display" id="eq:prod4w">\[
\mathbb{P}(\mathbf{\mathbf{Y_{t+dt}}}=\mathbf{T_k}|\mathbf{\mathbf{Y_t}}=\mathbf{T_l}, \mathbf{W}=\mathbf{w}) =
 \prod_{\substack{i_1\in I_1}}g_{i_1}(v_{i_1,t}, \mathbf{w})dt
 \prod_{\substack{i_2\in I_2}}f_{i_2}(v_{i_2,t}, \mathbf{w})dt
 \prod_{\substack{i_3\in I_3}}(1-f_{i_3}(v_{i_3,t}, \mathbf{w})dt)
 \prod_{\substack{i_4\in I_4}}(1-g_{i_4}(\mathbf{w}, v_{i_4,t})dt)
 \tag{3.1}
\]</span></p>
</div>
<div id="using-markov-chains" class="section level1">
<h1 class="hasAnchor">
<a href="#using-markov-chains" class="anchor"></a><span class="header-section-number">4</span> Using Markov chains</h1>
<p>Using equation <a href="#eq:prod4w">(3.1)</a>, we spawn the transition matrix of a discrete
Markov chain <span class="math inline">\(\mathbf{M_w^{dt}}\)</span>. For a given environment <span class="math inline">\(\mathbf{w}\)</span>,
this matrix describes the probabilities to switch from one state to
another during <span class="math inline">\(dt\)</span>. Its coefficients are obtained as follows:</p>
<p><span class="math display" id="eq:mark1">\[
\forall (k,l)\in \{ 1,2,..., 2^P\}^2,~ \mu_{k,l}=\mathbb{P}(\mathbf{\mathbf{Y_{t+dt}}}=\mathbf{T_k}|\mathbf{\mathbf{Y_t}}=\mathbf{T_l}, \mathbf{W}=\mathbf{w})
\tag{4.1}
\]</span></p>
<p>Now, let <span class="math inline">\(\mathbf{C_w}(t)\)</span> be the line vector defines at each time <span class="math inline">\(t\)</span> by:</p>
<p><span class="math display" id="eq:mark2">\[
\begin{aligned}
 \nonumber \mathbf{C_w}(t) &amp;=&amp; \left(\mathbb{P}(\mathbf{\mathbf{Y_t}}=\mathbf{T_1}|\mathbf{W}=\mathbf{w}), \mathbb{P}(\mathbf{\mathbf{Y_t}}=\mathbf{T_2}|\mathbf{W}=\mathbf{w}),...,\right. \\
 &amp; &amp; \left.\mathbb{P}(\mathbf{\mathbf{Y_t}}=\mathbf{T_{2^n}}|\mathbf{W}=\mathbf{w})\right)
\end{aligned}
\tag{4.2}
\]</span></p>
<p>This vector describes probabilities of each possible island composition
at any time <span class="math inline">\(t\)</span>, we then derive <span class="math inline">\(\mathbf{C_w}(t+dt)\)</span> from
<span class="math inline">\(\mathbf{C_w}(t)\)</span> as follows:</p>
<p><span class="math display" id="eq:mark3">\[
\mathbf{C_w}(t+dt)=\mathbf{C_w}(t)\mathbf{M_w^{dt}}
\tag{4.3}
\]</span></p>
<p>We assume that none of the <span class="math inline">\(\mathbf{M^{dt}_w}\)</span> is null, which yields a
regular Markov chain. In such case, <span class="math inline">\(\mathbf{C}(t)\)</span> converges to an
equilibrium value <span class="math inline">\(\mathbf{C_{eq}}\)</span> when <span class="math inline">\(t\)</span> increases:</p>
<p><span class="math display" id="eq:mark4">\[
\lim\limits_{\substack{l \to +\infty }} \mathbf{C}_0(\mathbf{M^{dt}_w})^l=\mathbf{C_{eq}}
\tag{4.4}
\]</span></p>
<p>This <span class="math inline">\(\mathbf{C_{eq}}\)</span> satisfies:</p>
<p><span class="math display">\[
\mathbf{C_{eq}}(\mathbf{M^{dt}_w}) = \mathbf{C_{eq}}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
||\mathbf{C_{eq}}|| = 1
\]</span></p>
<p>Therefore, <span class="math inline">\(\mathbf{C_{eq}}\)</span> is given by the normalized left Eigen vector
associated to left Eigen value 1.</p>
</div>
<div id="time-continuous-markov-chain" class="section level1">
<h1 class="hasAnchor">
<a href="#time-continuous-markov-chain" class="anchor"></a><span class="header-section-number">5</span> Time continuous Markov chain</h1>
<p>We show here how we can get the generator matrix of the time-continuous
Markov chain associated to the transition matrix <span class="math inline">\(\mathbf{M^{dt}_w}\)</span>. We
then provide an explicit solution of the system of differential
equations we derived.</p>
<div id="solution-for-two-species" class="section level2">
<h2 class="hasAnchor">
<a href="#solution-for-two-species" class="anchor"></a><span class="header-section-number">5.1</span> Solution for two species</h2>
<p>We start with <span class="math inline">\(P=2\)</span>, we denote: <span class="math inline">\(\mathbf{T_1}=(1,1)\)</span>,
<span class="math inline">\(\mathbf{T_2}=(1,0)\)</span>, <span class="math inline">\(\mathbf{T_3}=(0,1)\)</span> and <span class="math inline">\(\mathbf{T_4}=(0,0)\)</span>. We
consider here that <span class="math inline">\(\mathbf{W}\)</span> is set to <span class="math inline">\(\mathbf{w}\)</span> and so, for
instance, <span class="math inline">\(\mathbb{P}(\mathbf{\mathbf{Y_t}}=\mathbf{T_1})\)</span> means
<span class="math inline">\(\mathbb{P}(\mathbf{\mathbf{Y_t}}=\mathbf{T_1}|\mathbf{W}=\mathbf{w})\)</span>.</p>
<p><span class="math display" id="eq:contin0">\[
\begin{aligned}
\nonumber \mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}) &amp;=&amp; \mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}|\mathbf{Y_t}=\mathbf{T_1})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}) \\
\nonumber &amp; &amp; +\mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}|\mathbf{Y_t}=\mathbf{T_2})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) \\
\nonumber &amp; &amp; + \mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}|\mathbf{Y_t}=\mathbf{T_3})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
&amp; &amp; + \mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}|\mathbf{Y_t}=\mathbf{T_4})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_4})
\end{aligned}
\tag{5.1}
\]</span></p>
<p>As in this stage, as <span class="math inline">\(\mathbf{Y_t}\)</span> do not refer to the same values for the
whole equation, we slightly change our denotation: <span class="math inline">\(v_{i,\mathbf{T_j}}\)</span>
represents <span class="math inline">\(v_{i,t}\)</span> when <span class="math inline">\(\mathbf{Y_t}=\mathbf{T_j}\)</span>. According to
<a href="#eq:prod4w">(3.1)</a>, we get:</p>
<p><span class="math display" id="eq:contin1">\[
\begin{aligned}
\mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1})&amp;=&amp;(1-f_1(v_{1,\mathbf{T_1}},\mathbf{w})dt)(1-f_2(v_{2,\mathbf{T_1}},\mathbf{w})dt)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})\\
&amp; &amp; +(1-f_1(v_{1,\mathbf{T_2}},\mathbf{w})dt)g_2(v_{2,\mathbf{T_2}},\mathbf{w})dt \mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) \\
&amp; &amp; +g_1(v_{1,\mathbf{T_3}},\mathbf{w})dt(1-f_2(v_{2,\mathbf{T_3}},\mathbf{w})dt)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
&amp; &amp; +g_1(v_{1,\mathbf{T_4}},\mathbf{w})g_2(v_{2,\mathbf{T_4}},\mathbf{w})dt^2\mathbb{P}(\mathbf{Y_t}=\mathbf{T_4}) +o(dt)
\end{aligned}
\tag{5.2}
\]</span></p>
<p>This yields:</p>
<p><span class="math display" id="eq:contin2">\[
\begin{aligned}
\label{eqAnn2_5.3} \nonumber \mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1})&amp;=&amp;(1-f_1(v_{1,\mathbf{T_1}},\mathbf{w})dt-f_2(v_{2,\mathbf{T_1}},\mathbf{w})dt \\
\nonumber &amp; &amp; +f_1(v_{1,\mathbf{T_1}},\mathbf{w})f_2(v_{2,\mathbf{T_1}},\mathbf{w})dt^2)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})\\
\nonumber &amp; &amp; +((g_2(v_{2,\mathbf{T_2}},\mathbf{w})dt-g_2(v_{2,\mathbf{T_2}},\mathbf{w})f_1(v_{1,\mathbf{T_2}},\mathbf{w})dt^2))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) \\
\nonumber &amp; &amp; +(g_1(v_{1,\mathbf{T_3}},\mathbf{w})dt-g_1(v_{1,\mathbf{T_3}},\mathbf{w})f_2(v_{2,\mathbf{T_3}},\mathbf{w})dt^2)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
&amp; &amp; +g_1(v_{1,\mathbf{T_4}},\mathbf{w})g_2(v_{2,\mathbf{T_4}},\mathbf{w})dt^2\mathbb{P}(\mathbf{Y_t}=\mathbf{T_4})+o(dt)\end{aligned}
\tag{5.3}
\]</span></p>
<p>Assuming <span class="math inline">\(dt&gt;0\)</span>:</p>
<p><span class="math display" id="eq:contin3">\[
\begin{aligned}
\label{eqAnn2_5.4}
\nonumber \frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})}{dt} &amp;=&amp;
\frac{\mathbb{P}(\mathbf{Y_{t+dt}}=\mathbf{T_1}) - \mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}}{dt}  \\
\nonumber &amp;=&amp; (-(f_1(v_{1,\mathbf{T_1}},\mathbf{w})+f_2(v_{2,\mathbf{T_1}},\mathbf{w})) \\
\nonumber &amp; &amp; f_1(v_{1,\mathbf{T_1}},\mathbf{w})f_2(v_{2,\mathbf{T_1}},\mathbf{w})dt)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})\\
\nonumber &amp; &amp; + ((g_2(v_{2,\mathbf{T_2}},\mathbf{w})-g_2(v_{2,\mathbf{T_2}},\mathbf{w})f_1(v_{1,\mathbf{T_2}},\mathbf{w})dt))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) \\
\nonumber &amp; &amp; + (g_1(v_{1,\mathbf{T_3}},\mathbf{w})-g_1(v_{1,\mathbf{T_3}},\mathbf{w})f_2(v_{2,\mathbf{T_3}},\mathbf{w})dt)\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
&amp; &amp; +g_1(v_{1,\mathbf{T_4}},\mathbf{w})g_2(v_{2,\mathbf{T_4}},\mathbf{w})dt\mathbb{P}(\mathbf{Y_t}=\mathbf{T_4})+\frac{o(dt)}{dt}
\end{aligned}
\tag{5.4}
\]</span></p>
<p>When passing to the limit, we derive the following master equation:</p>
<p><span class="math display" id="eq:contin4">\[
\begin{aligned}
\nonumber\frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})}{dt} &amp;=&amp; -(f_1(v_{1,\mathbf{T_1}},\mathbf{w})+f_2(v_{2,\mathbf{T_1}},\mathbf{w}))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}) +g_2(v_{2,\mathbf{T_2}},\mathbf{w})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2})\\ &amp; &amp;  + g_1(v_{1,\mathbf{T_3}},\mathbf{w})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3})
\end{aligned}
\tag{5.5}
\]</span></p>
<p>We do so for the <span class="math inline">\(\mathbf{T_2}\)</span>, <span class="math inline">\(\mathbf{T_3}\)</span> and <span class="math inline">\(\mathbf{T_4}\)</span>. Let
<span class="math inline">\(\mathbf{C}(t)\)</span> be the column vector define for all real <span class="math inline">\(t&gt;0\)</span> such as
<span class="math inline">\(\mathbf{C}(t)=(\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}),\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}),\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}), \mathbb{P}(\mathbf{Y_t}=\mathbf{T_4}))\)</span>. We thus have the following
relationship:</p>
<p><span class="math display" id="eq:contin5">\[
\mathbf{C}'(t) = \mathbf{C}(t)\mathbf{G_w}
\tag{5.6}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{G_w}\)</span> is:</p>
<p><span class="math display" id="eq:contin6">\[
\begin{aligned}
\nonumber
\left(\begin{array}{cccc}
-(f_1(v_{1,\mathbf{T_1}},\mathbf{w})+f_2(v_{2,\mathbf{T_1}},\mathbf{w})) &amp; f_1(v_{1,\mathbf{T_1}},\mathbf{w}) &amp; f_2(v_{2,\mathbf{T_1}},\mathbf{w}) &amp; 0 \\
g_2(v_{2,\mathbf{T_2}},\mathbf{w}) &amp; -(f_1(v_{1,\mathbf{T_2}},\mathbf{w})+g_2(v_{2,\mathbf{T_2}},\mathbf{w})) &amp; 0 &amp; f_1(v_{1,\mathbf{T_2}},\mathbf{w})\\
g_1(v_{1,\mathbf{T_3}},\mathbf{w}) &amp; 0 &amp; -(g_1(v_{1,\mathbf{T_3}},\mathbf{w})+f_2(v_{2,\mathbf{T_3}},\mathbf{w})) &amp; f_2(v_{2,\mathbf{T_3}},\mathbf{w}) \\
0 &amp; g_1(v_{1,\mathbf{T_4}},\mathbf{w}) &amp; g_2(v_{2,\mathbf{T_4}},\mathbf{w}) &amp; -(g_1(v_{1,\mathbf{T_4}},\mathbf{w})+g_2(v_{2,\mathbf{T_4}},\mathbf{w}))
\end{array}\right)
\end{aligned}
\tag{5.7}
\]</span></p>
<p>At the equilibrium, the solution is given by <span class="math inline">\(\mathbf{C_{eq}}\)</span> which
verifies:</p>
<p><span class="math display" id="eq:contin7">\[
\begin{aligned}
\mathbf{C_{eq}}\mathbf{G_w} &amp;=&amp; 0 \\
||\mathbf{C_{eq}}|| &amp;=&amp; 1
\end{aligned}
\tag{5.8}
\]</span></p>
<p>This is the normalized left Eigen vector associated to the left Eigen values 0.
We now <a href="#eq:contin5">(5.6)</a>. First, as <span class="math inline">\(\{ \mathbf{T_1}, \mathbf{T_2}, \mathbf{T_3}, \mathbf{T_4} \}\)</span> is a partition (which also justifies that 0 is a
left Eigen values):</p>
<p><span class="math display" id="eq:contin8">\[
\sum_{i=1}^4 \mathbb{P}(\mathbf{Y_t}=\mathbf{T_i})=1
\tag{5.9}
\]</span></p>
<p>so, we express <span class="math inline">\(\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3})\)</span> using the
probabilities:</p>
<p><span class="math display" id="eq:contin9">\[
\begin{aligned}
\nonumber \frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})}{dt} &amp;=&amp; -(f_1(v_{1,\mathbf{T_1}},\mathbf{w}) + f_2(v_{2,\mathbf{T_1}},\mathbf{w})) \mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})
\\  &amp; &amp; + g_2(v_{2,\mathbf{T_2}},\mathbf{w}) \mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) + g_1(v_{1,\mathbf{T_3}})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
\nonumber \frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2})}{dt} &amp;=&amp; g_1(v_{1,\mathbf{T_4}}, \mathbf{w})+(f_2(v_{2,\mathbf{T_1}}, \mathbf{w}) - g_1(v_{1,\mathbf{T_4}}, \mathbf{w}))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}) \\
\nonumber  &amp; &amp; - (f_1(v_{1,\mathbf{T_2}}, \mathbf{w})+g_2(v_{2,\mathbf{T_2}}, \mathbf{w})
g_1(v_{1,\mathbf{T_4}}, \mathbf{w}))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2}) \\
 &amp; &amp; - g_1(v_{1,\mathbf{T_4}}, \mathbf{w})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3}) \\
\nonumber \frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3})}{dt} &amp;=&amp; g_2(v_{2,\mathbf{T_4}}, \mathbf{w})+(f_1(v_{1,\mathbf{T_1}}, \mathbf{w})-g_2(v_{2,\mathbf{T_4}}, \mathbf{w}))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}) \\
\nonumber &amp; &amp; - g_2(v_{2,\mathbf{T_4}}, \mathbf{w})\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2})
-(g_1(v_{1,\mathbf{T_3}}, \mathbf{w})+f_2(v_{2,\mathbf{T_3}}, \mathbf{w}) \\
 &amp; &amp; + g_2(v_{2,\mathbf{T_4}}, \mathbf{w}))\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3})
 \end{aligned}
\tag{5.10}
\]</span></p>
<p>we denote:</p>
<p><span class="math display" id="eq:contin10">\[
\begin{aligned} \mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_2})=\mathbb{P}(\mathbf{Y_t}=\mathbf{T_2})-\frac{g_1(v_{1,\mathbf{T_4}}, \mathbf{w})}{f_1(v_{1,\mathbf{T_2}}, \mathbf{w})+g_2(v_{2,\mathbf{T_2}}, \mathbf{w})+g_1(v_{1,\mathbf{T_4}}, \mathbf{w})} \\
\label{eqAnn2_5.9} \mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_3})=\mathbb{P}(\mathbf{Y_t}=\mathbf{T_3})-\frac{g_2(v_{2,\mathbf{T_4}}, \mathbf{w})}{g_1(v_{1,\mathbf{T_3}}, \mathbf{w})+f_2(v_{2,\mathbf{T_3}}, \mathbf{w})+g_2(v_{2,\mathbf{T_4}}, \mathbf{w})}\end{aligned}
\tag{5.11}
\]</span></p>
<p>as:</p>
<p><span class="math display" id="eq:contin10">\[
\begin{aligned}
\frac{dP^\ast(\mathbf{Y_t}=\mathbf{T_2})}{dt}=\frac{dP(\mathbf{Y_t}=\mathbf{T_2})}{dt} \\
\frac{dP^\ast(\mathbf{Y_t}=\mathbf{T_3})}{dt}=\frac{dP(\mathbf{Y_t}=\mathbf{T_3})}{dt}
\end{aligned}
\tag{5.11}
\]</span></p>
<p>yielding:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{C}^{\ast'}(t)=\mathbf{C}^\ast(t)\mathbf{G_w}^\ast\end{aligned}
\]</span></p>
<p>where:</p>
<p><span class="math display" id="eq:contin12">\[
\begin{aligned}
\nonumber
\mathbf{C}^{\ast'}&amp;=&amp;\left(\begin{array}{ccc} \frac{d\mathbb{P}(\mathbf{Y_t}=\mathbf{T_1})}{dt} &amp; \frac{d\mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_2})}{dt} &amp; \frac{d\mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_3})}{dt} \end{array}\right) \\
%
\nonumber \mathbf{C}^{\ast}&amp;=&amp;\left(\begin{array}{ccc} \mathbb{P}(\mathbf{Y_t}=\mathbf{T_1}) &amp; \mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_2}) &amp; \mathbb{P}^\ast(\mathbf{Y_t}=\mathbf{T_3}) \end{array}\right)
\end{aligned}
\tag{5.12}
\]</span></p>
<p><span class="math display" id="eq:contin13">\[
\begin{aligned}
\nonumber \mathbf{G_w}^\ast&amp;=&amp; \scriptsize{
\left(\begin{array}{cccc}
-(f_1(v_{1,\mathbf{T_1}}, \mathbf{w})+f_2(v_{2,\mathbf{T_1}}, \mathbf{w})) &amp; f_2(v_{2,\mathbf{T_1}}, \mathbf{w})-g_1(v_{1,\mathbf{T_4}}, \mathbf{w})) &amp; (f_1(v_{1,\mathbf{T_1}}, \mathbf{w})-g_2(v_{2,\mathbf{T_4}}, \mathbf{w})) \\
(g_2(v_{2,\mathbf{T_2}}, \mathbf{w})  &amp; -(f_1(v_{1,\mathbf{T_2}}, \mathbf{w})+g_2(v_{2,\mathbf{T_2}}, \mathbf{w})+g_1(v_{1,\mathbf{T_4}}, \mathbf{w})) &amp; -g_2(v_{2,\mathbf{T_4}}, \mathbf{w})  \\
g_1(v_{1,\mathbf{T_3}}, \mathbf{w}) &amp; -g_1(v_{1,\mathbf{T_4}}, \mathbf{w})  &amp; -(g_1(v_{1,\mathbf{T_3}}, \mathbf{w})+f_2(v_{2,\mathbf{T_3}}, \mathbf{w})+g_2(v_{2,\mathbf{T_4}}, \mathbf{w}))
\end{array}\right)}
\end{aligned}
\tag{5.13}
\]</span></p>
<p>then, if <span class="math inline">\(\mathbf{G_w}^\ast\)</span> is diagonizable, we readily solve <a href="#eq:contin12">(5.12)</a>.</p>
<p><span class="math display" id="eq:contin14">\[
\mathbf{C}^{\ast'} = \mathbf{CZDZ^{-1}}
\tag{5.14}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{D}\)</span> is the diagonal matrix containing the Eigen values of <span class="math inline">\(\mathbf{G_w}^\ast\)</span>
and <span class="math inline">\(\mathbf{Z}\)</span>, the matrix permitting the change of basis:</p>
<p><span class="math display" id="eq:contin15">\[
\mathbf{C}^{\ast'}\mathbf{Z} = \mathbf{CZD}
\tag{5.15}
\]</span></p>
<p>Thus we have to
solve a homogeneous system of differential equations:</p>
<p><span class="math display" id="eq:contin16">\[
\mathbf{C}^{\ast}(t)\mathbf{Z} = \mathbf{K}\exp(\Lambda t)
\tag{5.16}
\]</span></p>
<p>Where:</p>
<p><span class="math display" id="eq:contin17">\[
\begin{aligned}
\nonumber \exp(\Lambda t)&amp;=&amp;
\left(\begin{array}{cccc}
\exp(\lambda_1t) &amp; 0 &amp; 0 \\
0 &amp; \exp(\lambda_2t) &amp; 0  \\
0  &amp; 0 &amp; \exp(\lambda_3t)
\end{array}\right)
\end{aligned}
\tag{5.17}
\]</span></p>
<p>where <span class="math inline">\(\lambda_i\)</span> stands for the <span class="math inline">\(i\)</span> Eigen values of <span class="math inline">\(\mathbf{G_w}^\ast\)</span>,
therefore:</p>
<p><span class="math display" id="eq:contin18">\[
\mathbf{C}^{\ast}(t) = \mathbf{K}\exp(\Lambda t)\mathbf{Z^{-1}}
\tag{5.18}
\]</span></p>
<p>Furthermore, given:</p>
<p><span class="math display" id="eq:contin19">\[
\mathbf{C}^{\ast}(0) = \mathbf{KZ^{-1}}
\tag{5.19}
\]</span></p>
<p>we obtain:</p>
<p><span class="math display" id="eq:contin20">\[
\mathbf{C}^{\ast}(t) = \mathbf{C}^{\ast}(0)\mathbf{Z}\exp(\Lambda t)\mathbf{Z^{-1}}
\tag{5.20}
\]</span></p>
<p><span class="math inline">\(\mathbf{C}(t)\)</span> is finally obtained by adding the two constants we have
subtracted in <a href="#eq:contin8">(5.9)</a> and <a href="#eq:contin9">(5.10)</a>. This allows us to express
the expected values of local richness <span class="math inline">\(S(t)\)</span> as the following matrix product:</p>
<p><span class="math display" id="eq:contin21">\[
\mathbb{E}({S}(t)) = \mathbf{C}(t)\mathbf{N}^T
\tag{5.21}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{N}\)</span> is the vector defined as
<span class="math inline">\(\mathbf{N}=(||\mathbf{T_1}||^2, ||\mathbf{T_2}||^2, ||\mathbf{T_3}||^2, ||\mathbf{T_4}||^2)\)</span>,
where $ || ~~ || $ denotes the Euclidean norm. In our example, we have
<span class="math inline">\(\mathbf{N}=(2,1,1,0)\)</span>.</p>
</div>
<div id="solution-for-p-species" class="section level2">
<h2 class="hasAnchor">
<a href="#solution-for-p-species" class="anchor"></a><span class="header-section-number">5.2</span> Solution for <span class="math inline">\(P\)</span> species</h2>
<p>We first build <span class="math inline">\(\mathbf{M_w^{dt}}\)</span> for <span class="math inline">\(P\)</span> species, we then recall equation
<a href="#eq:prod4w">(3.1)</a> and consider the expression of the conditional probabilities
between any pair of states
(<span class="math inline">\(\mathbf{Y_{t+dt}}=\mathbf{T_i},\mathbf{Y_t}=\mathbf{T_j}\)</span>). We assume
simultaneous colonization and/or extinction of different species to be
neglectable when <span class="math inline">\(dt\)</span> tends towards 0 (this is shown using <a href="#eq:prod4w">(3.1)</a>,
this kind of events are indeed multiplied by <span class="math inline">\(dt^m\)</span> with <span class="math inline">\(m\geqslant2\)</span>).
Consequently, we distinguish the different cases associated to the number of
changes in presence status of species. To do so, we consider all values
<span class="math inline">\(||\mathbf{T_i}-\mathbf{T_j}||\)</span> takes. Note that when <span class="math inline">\(i=j\)</span> (diagonal terms),
the island composition is unchanged during <span class="math inline">\(dt\)</span>.</p>
<p><span class="math display" id="eq:contin22">\[
\begin{aligned}
\nonumber \mathbb{P}(\mathbf{Y_{t+dt}=\mathbf{T_j} | \mathbf{Y_{t}=\mathbf{T_j})}} &amp;=&amp; \prod_{i_3 \in I_3}(1-f_{i_3}(v_{i_3,\mathbf{T_j}}, \mathbf{w})dt)\prod_{i_4 \in I_4}(1-g_{i_4}(v_{i_4,\mathbf{T_j}}, \mathbf{w})dt) \\
&amp;&amp;
\end{aligned}
\tag{5.22}
\]</span></p>
<p>yielding:</p>
<p><span class="math display" id="eq:contin23">\[
\begin{aligned}
\mu_{j,j} &amp;=&amp; 1-\sum_{i_3 \in I_3}f_{i_3}(v_{i_3,\mathbf{T_j}}, \mathbf{w})dt- \sum_{i_4 \in I_4}g_{i_4}(v_{i_4,\mathbf{T_j}}, \mathbf{w})dt+o(dt)
\end{aligned}
\tag{5.23}
\]</span></p>
<p>when <span class="math inline">\(i \neq j\)</span>, we consider three cases:</p>
<p><span class="math display" id="eq:contin24">\[
\begin{aligned}
\label{eqAnn2_5.22} ||\mathbf{T_i}-\mathbf{T_j}|| = 1, ~(\mathbf{T_i}-\mathbf{T_j})_l=1 &amp;\Rightarrow&amp; \mu_{j,i}= g_l(v_{l,\mathbf{T_j}}, \mathbf{w})dt+ o(dt) \\
\label{eqAnn2_5.23} ||\mathbf{T_i}-\mathbf{T_j}||  =1  , ~(\mathbf{T_i}-\mathbf{T_j})_l=-1 &amp;\Rightarrow&amp; \mu_{j,i}= f_l(v_{l,\mathbf{T_j}}, \mathbf{w})dt+o(dt) \\
||\mathbf{T_i}-\mathbf{T_j}||  &gt;1 &amp;\Rightarrow&amp; \mu_{j,i}=o(dt)
\end{aligned}
\tag{5.24}
\]</span></p>
<p>Here <span class="math inline">\(l\)</span> denotes the identity of the species that go extinct or colonize
the island during <span class="math inline">\(dt\)</span>. Then, we derive <span class="math inline">\(\mathbf{G_w}\)</span> from the previous
results. Let <span class="math inline">\(K_1\)</span> and <span class="math inline">\(K_2\)</span> be the groups of states which respectively
correspond to <a href="#eq:contin22">(5.22)</a> and <a href="#eq:contin23">(5.23)</a>. For any
state <span class="math inline">\(\mathbf{T_i}\)</span>:</p>
<p><span class="math display" id="eq:contin25">\[
\begin{aligned}
\nonumber \mathbb{P}(\mathbf{Y_{t+dt} = \mathbf{T_i})} &amp;=&amp; \sum_{k_1 \in K_1}g_{l(k_1)}(v_{l(k_1)},\mathbf{T_{k_1}}, \mathbf{w})dt\mathbb{P}(\mathbf{Y_{t}=\mathbf{T_{k_1}})} \\
\nonumber  &amp; &amp; + \sum_{k_2 \in K_2} f_{l(k_2)}(v_{l(k_2)},\mathbf{T_{k_2}}, \mathbf{w}) dt \mathbb{P}(\mathbf{Y_{t}}=\mathbf{T_{k_2})} \\
\nonumber  &amp; &amp; + \left(1-\sum_{i_3 \in I_3}f_{i_3}(v_{i_3,\mathbf{T_j}}, \mathbf{w})dt- \sum_{i_4 \in I_4}g_{i_4}(v_{i_4,\mathbf{T_j}}, \mathbf{w})dt \right)\mathbb{P}(\mathbf{Y_{t}=\mathbf{T_i})} \\
  &amp; &amp; + o(dt)
\end{aligned}
\tag{5.25}
\]</span></p>
<p>Therefore:</p>
<p><span class="math display" id="eq:contin26">\[
\begin{aligned}
\nonumber \frac{d\mathbb{P}(\mathbf{Y_{t}}=\mathbf{T_i})}{dt} &amp;=&amp; \sum_{k_1 \in K_1}g_{l(k_1)}(v_{l(k_1)},\mathbf{T_{k_1}}, \mathbf{w})\mathbb{P}(\mathbf{Y_{t}=\mathbf{T_{k_1}})} \\
 \nonumber &amp; &amp; + \sum_{k_2 \in K_2} f_{l(k_2)}(v_{l(k_2)},\mathbf{T_{k_2}}, \mathbf{w}) \mathbb{P}(\mathbf{Y_{t}}=\mathbf{T_{k_2})} + \\
 &amp; &amp; \left(-\sum_{i_3 \in I_3}f_{i_3}(v_{i_3,\mathbf{T_j}}, \mathbf{w})- \sum_{i_4 \in I_4}g_{i_4}(v_{i_4,\mathbf{T_j}}, \mathbf{w}) \right)\mathbb{P}(\mathbf{Y_{t}=\mathbf{T_i})}
\end{aligned}
\tag{5.26}
\]</span></p>
<p>Hence, <span class="math inline">\(\mathbf{G_w}\)</span> is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
||\mathbf{T_j}-\mathbf{T_i}|| = 1, ~ (\mathbf{T_j-T_i})_l=1 &amp;\Rightarrow&amp; \gamma_{i,j}= f(v_{l,\mathbf{T_i}}, \mathbf{w}) \\
||\mathbf{T_j}-\mathbf{T_i}||  =1  ,~ (\mathbf{T_j-T_i})_l=-1&amp;\Rightarrow&amp; \gamma_{i,j}= g(v_{l,\mathbf{T_i}}, \mathbf{w}) \\
||\mathbf{T_j}-\mathbf{T_i}||  &gt;1 &amp;\Rightarrow&amp; \gamma_{i,j}=0
\end{aligned}
\]</span></p>
<p>for the diagonal elements, we get:</p>
<p><span class="math display" id="eq:contin27">\[
\begin{aligned}
\gamma_{j,j} &amp;=&amp; \left(-\sum_{i_3 \in I_3}f_{i_3}(v_{i_3,\mathbf{T_j}}, \mathbf{w})- \sum_{i_4 \in I_4}g_{i_4}(v_{i_4,\mathbf{T_j}}, \mathbf{w}) \right)
\end{aligned}
\tag{5.27}
\]</span></p>
<p>Finally, the solution of the expected richness is given by following the
different steps from <a href="#eq:contin8">(5.9)</a> to <a href="#eq:contin21">(5.21)</a>.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>MacArthur, R. H. and Wilson, E. O. 1967. Theory of island
biogeography. – Princeton Univ. Press. <a href="https://press.princeton.edu/books/paperback/9780691088365/the-theory-of-island-biogeography">ISBN: 0691088365</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Cazelles.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
